{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$defs": {
    "subchart": {
      "additionalProperties": {
        "properties": {
          "chart": {
            "default": "uchart",
            "type": "string"
          },
          "chartUrl": {
            "default": "registry.gamewarden.io/charts",
            "type": "string"
          },
          "enabled": {
            "default": true,
            "type": "boolean"
          },
          "name": {
            "type": "string"
          },
          "namespace": {
            "type": "string"
          },
          "project": {
            "type": "string"
          },
          "revision": {
            "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+$",
            "type": "string"
          },
          "sync": {
            "default": true,
            "type": "boolean"
          },
          "valueFiles": {
            "items": {
              "type": "string"
            },
            "type": "array"
          },
          "values": {
            "type": "object"
          },
          "valuesRepo": {
            "type": "string"
          },
          "wave": {
            "type": "string"
          }
        },
        "additionalProperties": false,
        "type": "object"
      },
      "required": [],
      "type": "object"
    },
    "microservice": {
      "additionalProperties": {
        "properties": {
          "args": {
            "description": "Override startup command arguments for container.",
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "command": {
            "items": {
              "type": "string"
            },
            "description": "Override startup command for container.",
            "type": "array"
          },
          "config": {
            "description": "See example: https://github.com/second-front/uchart/blob/main/docs/Example-Microservices.md?plain=1#L74-L82",
            "properties": {
              "data": {
                "additionalProperties": {
                  "type": "string"
                },
                "type": "object"
              }
            },
            "type": "object"
          },
          "cronjob": {
            "description": "Add kubernetes cronjobs: https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/",
            "type": "object",
            "additionalProperties": false,
            "properties": {
              "backoffLimit": {
                "description": "https://kubernetes.io/docs/concepts/workloads/controllers/job/#pod-backoff-failure-policy",
                "type": "integer"
              },
              "completions": {
                "description": "https://kubernetes.io/docs/concepts/workloads/controllers/job/#completion-mode",
                "type": "integer"
              },
              "concurrencyPolicy": {
                "description": "https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/#concurrency-policy",
                "type": "string"
              },
              "enabled": {
                "description": "Turn on or off the creation of the cronjob.",
                "type": "boolean"
              },
              "failedJobsHistoryLimit": {
                "description": "https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/#jobs-history-limits",
                "type": "integer"
              },
              "parallelism": {
                "description": "https://kubernetes.io/docs/concepts/workloads/controllers/job/#parallel-jobs",
                "type": "integer"
              },
              "schedule": {
                "description": "https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/#schedule-syntax",
                "type": "string"
              },
              "successfulJobsHistoryLimit": {
                "description": "https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/#jobs-history-limits",
                "type": "integer"
              },
              "suspended": {
                "description": "https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/#schedule-suspension",
                "type": "boolean"
              }
            }
          },
          "envFrom": {
            "items": {
              "properties": {
                "configMapRef": {
                  "additionalProperties": false,
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string"
                    }
                  }
                },
                "secretRef": {
                  "additionalProperties": false,
                  "type": "object",
                  "properties": {
                    "name": {
                      "type": "string"
                    }
                  }
                }
              },
              "additionalProperties": false,
              "type": "object"
            },
            "description": "https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/#configure-all-key-value-pairs-in-a-configmap-as-container-environment-variables",
            "type": "array"
          },
          "envs": {
            "additionalProperties": {
              "type": "string"
            },
            "type": "object",
            "description": "Key value pair for environment variables: https://github.com/second-front/uchart/blob/main/docs/Example-Microservices.md?plain=1#L49-L51"
          },
          "extraEnvs": {
            "description": "See example: https://github.com/second-front/uchart/blob/main/docs/Example-Microservices.md?plain=1#L54-L65",
            "items": {
              "properties": {
                "name": {
                  "type": "string"
                },
                "value": {
                  "type": "string"
                },
                "valueFrom": {
                  "properties": {
                    "configMapKeyRef": {
                      "additionalProperties": false,
                      "properties": {
                        "key": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        }
                      },
                      "type": "object"
                    },
                    "secretKeyRef": {
                      "additionalProperties": false,
                      "properties": {
                        "key": {
                          "type": "string"
                        },
                        "name": {
                          "type": "string"
                        }
                      },
                      "type": "object"
                    }
                  },
                  "additionalProperties": false,
                  "type": "object"
                }
              },
              "additionalProperties": false,
              "type": "object",
              "required": ["name"]
            },
            "type": "array"
          },
          "image": {
            "properties": {
              "name": {
                "description": "The name of the image. Defaults to microservice name.",
                "type": "string"
              }
            },
            "required": ["name"],
            "additionalProperties": false,
            "type": "object"
          },
          "livenessProbe": {
            "description": "See documentation: https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/",
            "properties": {
              "failureThreshold": {
                "description": "Number of failed checks to consider the liveness check failed.",
                "type": "integer"
              },
              "initialDelaySeconds": {
                "description": "Amount of seconds to send the first probe.",
                "type": "integer"
              },
              "periodSeconds": {
                "description": "How often the probe checks for liveness.",
                "type": "integer"
              },
              "successThreshold": {
                "description": "Minimum successful attempts needed to be deemed alive.",
                "type": "integer"
              },
              "timeoutSeconds": {
                "description": "Number of seconds after which a probe times out.",
                "type": "integer"
              },
              "tcpSocket": {
                "properties": {
                  "port": {
                    "type": "integer"
                  }
                },
                "additionalProperties": false,
                "type": "object"
              },
              "httpGet": {
                "properties": {
                  "path": {
                    "type": "string"
                  },
                  "port": {
                    "type": "integer"
                  }
                },
                "additionalProperties": false,
                "type": "object"
              }
            },
            "additionalProperties": false,
            "type": "object"
          },
          "readinessProbe": {
            "description:": "See documentation: https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/",
            "properties": {
              "failureThreshold": {
                "description": "Number of failed checks to consider the liveness check failed.",
                "type": "integer"
              },
              "initialDelaySeconds": {
                "description": "Amount of seconds to send the first probe.",
                "type": "integer"
              },
              "periodSeconds": {
                "description": "How often the probe checks for liveness.",
                "type": "integer"
              },
              "successThreshold": {
                "description": "Minimum successful attempts needed to be deemed alive.",
                "type": "integer"
              },
              "tcpSocket": {
                "properties": {
                  "port": {
                    "type": "integer"
                  }
                },
                "additionalProperties": false,
                "type": "object"
              },
              "timeoutSeconds": {
                "description": "Number of seconds after which a probe times out.",
                "type": "integer"
              }
            },
            "additionalProperties": false,
            "type": "object"
          },
          "resources": {
            "description": "See documentation: https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/",
            "properties": {
              "limits": {
                "properties": {
                  "cpu": {
                    "type": "string"
                  },
                  "memory": {
                    "type": "string"
                  }
                },
                "additionalProperties": false,
                "type": "object"
              },
              "requests": {
                "properties": {
                  "cpu": {
                    "type": "string"
                  },
                  "memory": {
                    "type": "string"
                  }
                },
                "additionalProperties": false,
                "type": "object"
              }
            },
            "additionalProperties": false,
            "type": "object"
          },
          "service": {
            "description": "See documentation: https://kubernetes.io/docs/concepts/services-networking/service/",
            "properties": {
              "additionalPorts": {
                "items": {
                  "properties": {
                    "name": {
                      "type": "string"
                    },
                    "port": {
                      "type": "integer"
                    },
                    "protocol": {
                      "type": "string"
                    },
                    "targetPort": {
                      "type": "integer"
                    },
                    "appProtocol": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false,
                  "required": ["name", "port", "protocol", "targetPort"],
                  "type": "object"
                },
                "type": "array"
              },
              "port": {
                "type": "integer"
              },
              "targetPort": {
                "type": "integer"
              },
              "appProtocol": {
                "type": "string"
              },
              "type": {
                "type": "string"
              }
            },
            "additionalProperties": false,
            "type": "object"
          },
          "topologySpreadConstraints": {
            "items": {
              "properties": {
                "labelSelector": {
                  "properties": {
                    "matchLabels": {
                      "additionalProperties": {
                        "type": "string"
                      },
                      "type": "object"
                    }
                  },
                  "type": "object"
                },
                "maxSkew": {
                  "type": "integer"
                },
                "topologyKey": {
                  "type": "string"
                },
                "whenUnsatisfiable": {
                  "type": "string"
                }
              },
              "type": "object"
            },
            "type": "array"
          },
          "volumeMounts": {
            "items": {
              "properties": {
                "mountPath": {
                  "type": "string"
                },
                "name": {
                  "type": "string"
                }
              },
              "type": "object"
            },
            "type": "array"
          },
          "volumes": {
            "items": {
              "properties": {
                "configMap": {
                  "properties": {
                    "items": {
                      "items": {
                        "properties": {
                          "key": {
                            "type": "string"
                          },
                          "path": {
                            "type": "string"
                          }
                        },
                        "type": "object"
                      },
                      "type": "array"
                    },
                    "name": {
                      "type": "string"
                    }
                  },
                  "type": "object"
                },
                "name": {
                  "type": "string"
                }
              },
              "type": "object"
            },
            "type": "array"
          }
        },
        "additionalProperties": false,
        "type": "object",
        "required": ["image"]
      },
      "required": [],
      "type": "object"
    }
  },
  "properties": {
    "microservices": {
      "$ref": "#/$defs/microservice",
      "required": [],
      "title": "microservices",
      "type": "object"
    },
    "subCharts": {
      "$ref": "#/$defs/subchart",
      "required": [],
      "title": "subCharts",
      "type": "object"
    }
  },
  "additionalProperties": false,
  "required": [],
  "type": "object"
}
